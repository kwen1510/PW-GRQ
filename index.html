<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Interview Transcription">
    <meta name="theme-color" content="#1e40af">
    <title>Interview Transcription App</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1><i class="fas fa-microphone"></i> Interview Transcription</h1>
            <p class="subtitle">Record and transcribe group interviews with ease</p>
            <div class="header-nav">
                <a href="/history.html" class="nav-link">
                    <i class="fas fa-history"></i> History
                </a>
            </div>
        </header>

        <main class="main">
            <!-- Setup Section -->
            <section class="setup-section">
                <div class="card">
                    <h2><i class="fas fa-cog"></i> Setup Interview</h2>
                    
                    <div class="form-group">
                        <label for="questions">Interview Questions</label>
                        <div class="questions-container">
                            <div class="question-input-group">
                                <div class="question-header">
                                    <span class="question-number">Question 1</span>
                                    <button type="button" class="remove-question-btn" onclick="removeQuestion(0)" style="display: none;">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                                <textarea class="question-input" placeholder="Enter your first interview question here..." rows="2"></textarea>
                            </div>
                        </div>
                        <div class="questions-controls">
                            <button type="button" id="addQuestionBtn" class="btn btn-secondary">
                                <i class="fas fa-plus"></i> Add Another Question
                            </button>
                            <div class="questions-info">
                                <span id="questionCount">1 question</span>
                                <small>You can also add questions during the interview</small>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Student Names</label>
                        <div class="student-inputs">
                            <input type="text" id="student1" placeholder="Student 1 name" class="student-input">
                            <input type="text" id="student2" placeholder="Student 2 name" class="student-input">
                            <input type="text" id="student3" placeholder="Student 3 name" class="student-input">
                            <input type="text" id="student4" placeholder="Student 4 name" class="student-input">
                            <input type="text" id="student5" placeholder="Student 5 name" class="student-input">
                        </div>
                    </div>

                    <button id="startSetup" class="btn btn-primary">
                        <i class="fas fa-play"></i> Start Interview
                    </button>
                </div>
            </section>

            <!-- Interview Section -->
            <section class="interview-section" style="display: none;">
                <div class="card">
                    <div class="interview-header">
                        <div class="question-display">
                            <h3><i class="fas fa-question-circle"></i> Question</h3>
                            <p id="displayQuestion"></p>
                        </div>
                        
                        <div class="timer-controls">
                            <div class="timer">
                                <i class="fas fa-clock"></i>
                                <span id="timer">00:00</span>
                            </div>
                            <!-- Record button removed - recording starts automatically -->
                            <button id="recordBtn" class="btn btn-record" style="display: none;">
                                <i class="fas fa-microphone"></i> Start Recording
                            </button>
                            <button id="endSessionBtn" class="btn btn-stop">
                                <i class="fas fa-stop-circle"></i> End Session
                            </button>
                        </div>
                    </div>

                    <!-- Student Selection -->
                    <div class="students-container">
                        <h3><i class="fas fa-users"></i> Select Current Speaker</h3>
                        <div class="student-boxes" id="studentBoxes">
                            <!-- Student boxes will be generated here -->
                        </div>
                        <div class="no-speaker">
                            <button id="noSpeaker" class="btn btn-secondary active">
                                <i class="fas fa-user-slash"></i> No Speaker Selected
                            </button>
                        </div>
                        
                        <!-- Session Navigation -->
                        <div class="session-navigation" id="sessionNavigation" style="display: none;">
                            <button id="nextQuestionBtn" class="btn btn-primary" title="Continue to next question">
                                <i class="fas fa-arrow-right"></i> Next Question
                            </button>
                            <p class="navigation-hint">Continue recording with the next question, or click "End Session" above when finished.</p>
                        </div>
                    </div>
                </div>

                <!-- Transcription Display -->
                <div class="card transcription-card">
                    <h3><i class="fas fa-file-alt"></i> Live Transcription</h3>
                    <div class="session-progress" id="sessionProgressDisplay" style="display: none;">
                        <div class="progress-info">
                            <span id="currentQuestionDisplay">Question 1</span>
                            <span id="totalQuestionsDisplay">of 3</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                    </div>
                    <div class="transcription-container" id="transcriptionContainer">
                        <p class="no-transcription">Transcription will appear here when recording starts...</p>
                    </div>
                </div>
                <!-- Session Completion Section (moved outside interview section) -->
            </section>

            <!-- Session Completion Section (moved outside interview section) -->
            <div class="session-completion-section" id="sessionCompletionSection" style="display: none;">
                <div class="card">
                    <h3><i class="fas fa-flag-checkered"></i> Session Complete - Review & Analyze</h3>
                    
                    <div class="session-summary">
                        <p><strong>Session Summary:</strong> <span id="sessionSummaryText"></span></p>
                        <p><strong>Total Recording Time:</strong> <span id="sessionDuration">00:00</span></p>
                    </div>

                    <div class="questions-review">
                        <h4><i class="fas fa-edit"></i> Review & Edit Questions</h4>
                        <p class="review-hint">Review and edit your questions before running the analysis. This helps ensure accurate context for the AI analysis.</p>
                        <div id="questionsReviewContainer">
                            <!-- Questions will be populated here -->
                        </div>
                    </div>

                    <div class="session-analysis">
                        <h4><i class="fas fa-brain"></i> Session Analysis</h4>
                        <div class="analysis-prompt-section">
                            <label for="sessionAnalysisPrompt">
                                <i class="fas fa-edit"></i> Analysis Prompt for Entire Session
                                <span class="prompt-hint">This prompt will analyze the complete session across all questions</span>
                            </label>
                            <textarea 
                                id="sessionAnalysisPrompt" 
                                rows="15"
                            >You are an AI feedback assistant reviewing a single question from a group oral response session.

**CRITICAL INSTRUCTION: ONLY USE ACTUAL QUOTES FROM THE TRANSCRIPT**
- You must ONLY reference and quote content that actually appears in the provided transcript
- DO NOT create, imagine, or paraphrase responses that weren't actually said
- If you reference a student's response, use their EXACT words in quotes
- If students didn't address certain aspects, state this clearly rather than inventing content

**ANALYSIS FOCUS:**
Provide focused feedback on how well the group addressed this specific question, including:

🔹 **Individual Student Responses:**
For each student who responded to this question:
- Quote their actual responses when providing feedback
- How well they addressed the specific question asked (based on what they actually said)
- Quality of their argument structure (PEEL: Point, Explanation, Evidence, Link) using their exact words
- Use of collaborative communication (quote actual phrases they used to build on others' ideas)
- Relevance and depth of their actual response to this particular question
- Specific suggestions for improvement with reference to what they actually said

🔹 **Group Dynamics for This Question:**
- How well the group collectively addressed the question (based on actual transcript content)
- Quality of collaboration and idea-building using actual examples from the transcript
- Whether the discussion stayed on-topic based on what was actually said
- How ideas actually developed and connected throughout the real responses

🔹 **Question-Specific Assessment:**
- Did the group fully address what was asked? (Reference actual responses)
- Were the actual responses appropriate to the question's complexity and scope?
- What aspects of the question were well-covered vs. missed in the real transcript?
- How could the group better approach this type of question based on their actual performance?

**EVALUATION CRITERIA:**

🟢 Collaborative Communication
• Quote actual collaborative signposting phrases used?
• Reference specific instances where students built upon teammates' ideas?
• Identify actual examples of shared ownership in the real discussion?
• Point to real examples of respectful and inclusive dialogue?

🔵 Quality of Argument (PEEL) - Using Actual Content
• Point – Quote clear, relevant points that directly address the question
• Explanation – Reference actual reasoning provided in the transcript
• Evidence/Example – Quote actual support provided in the responses
• Link – Reference actual connections made back to the question

🟣 Question Responsiveness - Based on Real Transcript
• Quote responses that directly addressed what was asked
• Reference actual demonstrations of understanding from the transcript
• Identify real depth provided in the actual responses
• Point to actual meaningful connections made across the discussion

**CONTENT QUALITY INDICATORS - Must Reference Actual Transcript:**
✔ Only reference content that actually appears in the transcript:
• Direct responses to the questions asked (quote actual responses)
• Problem identification, analysis, and solutions (use actual examples)
• Target group needs and stakeholder considerations (quote real mentions)
• Evidence-based reasoning and personal experiences (reference actual instances)
• Critical evaluation of ideas and approaches (quote actual evaluations)
• Creative and practical suggestions (reference actual suggestions made)

**OUTPUT FORMAT:**
Provide clear, student-friendly feedback with specific quotes from the actual transcript and actionable suggestions based on what students actually said or didn't say. Always distinguish between what students actually said versus what they could have said.</textarea>
                        </div>

                        <div class="session-analysis-controls">
                            <button id="runSessionAnalysisBtn" class="analysis-btn">
                                <i class="fas fa-magic"></i> Analyze Complete Session
                            </button>
                            <div class="session-analysis-status" id="sessionAnalysisStatus"></div>
                        </div>

                        <div class="session-analysis-results" id="sessionAnalysisResults" style="display: none;">
                            <h4><i class="fas fa-lightbulb"></i> Session Analysis Results</h4>
                            <div class="analysis-content" id="sessionAnalysisContent"></div>
                            <div class="analysis-actions">
                                <button id="copySessionAnalysisBtn" class="copy-btn">
                                    <i class="fas fa-copy"></i> Copy Analysis
                                </button>
                                <button id="downloadSessionWordBtn" class="copy-btn word-btn">
                                    <i class="fas fa-file-alt"></i> Download RTF
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Export Section -->
            <div class="card export-section">
                <h3><i class="fas fa-download"></i> Export & Save Data</h3>
                <div class="session-info" id="sessionInfo" style="display: none;">
                    <p><strong>Session Progress:</strong> <span id="sessionProgress">Question 1 of 1</span></p>
                    <p><strong>Total Questions:</strong> <span id="totalQuestions">1</span></p>
                </div>
                <div class="session-status" id="sessionStatus" style="display: none;">
                    <div class="status-indicator">
                        <i class="fas fa-circle" id="sessionStatusIcon"></i>
                        <span id="sessionStatusText">Session Active</span>
                    </div>
                </div>
                <div class="export-buttons">
                    <button id="exportCSV" class="btn btn-secondary" style="display: none;">
                        <i class="fas fa-file-csv"></i> Download CSV
                    </button>
                    <button id="exportJSON" class="btn btn-secondary" style="display: none;">
                        <i class="fas fa-file-code"></i> Download JSON
                    </button>
                    <button id="resetInterview" class="btn btn-outline">
                        <i class="fas fa-refresh"></i> New Session
                    </button>
                </div>
            </div>
        </main>

        <!-- Status Messages -->
        <div id="statusMessage" class="status-message"></div>
    </div>

    <script src="app.js"></script>
</body>
</html> 